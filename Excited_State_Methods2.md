# Excited State Methods: ROCIS, DFT/ROCIS, and EOM-CCSD

Understanding electronic excited states is crucial for interpreting spectroscopy, photochemistry, and reaction dynamics. While ground‐state methods (such as Hartree–Fock and density functional theory) are well established, treating excited states requires additional sophistication. In this blog, we explore three methods that address excited states from different perspectives:

- **Restricted Open-Shell Configuration Interaction Singles (ROCIS)**
- **DFT/ROCIS** (a hybrid approach that combines DFT with ROCIS)
- **Equation-of-Motion Coupled Cluster Singles and Doubles (EOM-CCSD)**

We begin with ROCIS and then build toward the more correlated and computationally demanding EOM-CCSD.

---

## 1. Restricted Open-Shell Configuration Interaction Singles (ROCIS)

### 1.1 Overview

The ROCIS method is designed to treat excited states in **open-shell systems**—often those with **unpaired electrons**, such as **transition-metal complexes or radicals**. As a member of the **configuration interaction singles (CIS) family**, ROCIS builds an excited state wavefunction as a **linear combination of singly excited configurations**, but it is formulated in a **restricted open-shell framework** so that spin symmetry and open-shell character are treated consistently. Moreover, ROCIS is often extended to include **spin–orbit coupling (SOC)** effects, which are crucial in **heavy-element and transition metal chemistry**.

---

### 1.2 The ROCIS Wavefunction and Hamiltonian

In ROCIS, an excited state wavefunction is written as:

$$
| \Psi_k \rangle = \sum_{i,a} c_{ia}^{(k)} | \Phi_{ia} \rangle. [1]
$$

where:

- $i$ labels **occupied orbitals** (which may come from a **restricted open‐shell Hartree–Fock or DFT reference**),
- $a$ labels **virtual orbitals**, and
- $c_{ia}^{(k)}$ are the **expansion coefficients** for the **$k^{\text{th}}$ excited state**.

Each determinant $| \Phi_{ia} \rangle$ is generated by promoting an electron from an **occupied orbital** $i$ to a **virtual orbital** $a$. In ROCIS, care is taken to ensure that **the open‐shell character is preserved** and that **proper spin coupling is maintained**.

The working Hamiltonian in ROCIS is typically partitioned as:

![image](https://github.com/user-attachments/assets/f62ac59d-e734-4dca-bf4e-cfe22097ce44) [2]


where:

- $\hat{H}_{\text{elec}}$ is the usual **nonrelativistic electronic Hamiltonian**, and
- $\hat{H}_{\text{SO}}$ is the **spin–orbit coupling operator**.

A common form for the **one-electron SOC operator** is:

$$
\hat{H}_{\text{SO}} = \sum_i \xi(r_i) \, \mathbf{L}_i \cdot \mathbf{S}_i. [3]
$$

with:

- $\xi(r_i)$ the (often parameterized) **radial spin–orbit coupling function**,
- $\mathbf{L}_i$ the **orbital angular momentum operator** for electron $i$, and
- $\mathbf{S}_i$ the **spin operator**.

---

### 1.3 Matrix Elements and the Eigenvalue Equation

The ROCIS approach leads to an eigenvalue problem of the form:

$$
\sum_{j,b} H_{ia,jb} \, c_{jb}^{(k)} = E_k \, c_{ia}^{(k)}. [4]
$$

where the Hamiltonian matrix elements are given by:

![image](https://github.com/user-attachments/assets/718519fa-bede-4915-9cb1-0ddd2e33ce2b) [5]


Let’s unpack each term:

- **Orbital Energy Difference:**
  
$(\epsilon_a - \epsilon_i ) \delta_{ij} \delta_{ab}$ represents the **zeroth-order energy cost** of exciting an electron from **orbital $i$ to $a$**.

- **Electron–Electron Interaction:**
  
$\langle ia || jb \rangle$ denotes the **antisymmetrized two-electron integral**:

$$
\langle ia || jb \rangle = \langle ia | jb \rangle - \langle ia | bj \rangle. [6]
$$

  where $\langle ia | jb \rangle$ is the **Coulomb integral** and $\langle ia | bj \rangle$ is the **exchange integral**.

- **Spin–Orbit Coupling:**  
The matrix element ![image](https://github.com/user-attachments/assets/cb8d90bc-ffe6-4494-aa6b-d22e161155ce) introduces **SOC effects**. In many **ROCIS implementations**, this term is computed using **effective one-electron operators** and often includes **empirical scaling** to account for deficiencies in the underlying electronic structure.

Together, Eq. (5) defines the **ROCIS Hamiltonian matrix** whose **diagonalization** yields **excitation energies** $E_k$ and coefficients $c_{ia}^{(k)}$.

---

## 2. DFT/ROCIS

### 2.1 Motivation and Concept

The **DFT/ROCIS** approach **combines** the efficiency of **density functional theory (DFT)** for obtaining **ground state properties** with the **ROCIS framework** for **excited states**. 

- **DFT reference** can **better capture electron correlation** than a **Hartree–Fock reference**.
- Empirical adjustments (e.g., **scaling factors** for two-electron integrals or **spin–orbit coupling strengths**) can be applied **to improve agreement** with **experimental excitation energies**.

---

### 2.2 The DFT/ROCIS Hamiltonian

In **DFT/ROCIS**, the starting point is a **DFT calculation**, yielding a set of **Kohn–Sham orbitals** $\{\phi_p\}$ and **orbital energies** $\{\epsilon_p\}$. The excited state wavefunction is expanded exactly as in Eq. (1):

$$
| \Psi_k \rangle = \sum_{i,a} c_{ia}^{(k)} | \Phi_{ia} \rangle.
$$

The Hamiltonian matrix elements are constructed similarly to Eq. (5), but with **two key modifications**:

1. **DFT-Derived Quantities:**  
   The **orbital energies** $\epsilon_i$ and $\epsilon_a$ are those obtained from the **DFT calculation**.

2. **Modified Two-Electron Integrals:**  
   A **scaling factor $\alpha$** is introduced for the electron–electron interaction term:

![image](https://github.com/user-attachments/assets/7e99b3a5-8ae6-49ca-ad23-4a9708d42596)


The parameter $\alpha$ is chosen (often **empirically**) so that the **DFT/ROCIS excitation energies** better reproduce **experimental spectra** or **benchmark calculations**.

---

## 3. Equation-of-Motion Coupled Cluster Singles and Doubles (EOM-CCSD)

### 3.1 Overview

**EOM-CCSD** is a **highly accurate, wavefunction-based method** for excited states that **systematically includes electron correlation effects** through **singles and doubles excitations**. Unlike **CIS or ROCIS**, **EOM-CCSD** is based on a **coupled cluster (CC) reference** that accounts for **dynamic correlation**.

### 3.2 The Ground State Coupled Cluster Wavefunction

EOM-CCSD starts with the ground state wavefunction expressed in the coupled cluster (CC) form:

$$
| \Psi_0 \rangle = e^{\hat{T}} | \Phi_0 \rangle. [9]
$$

where

- $| \Phi_0 \rangle$ is a Hartree–Fock reference determinant, and
- $\hat{T} = T_1 + T_2$ is the cluster operator including single ($T_1$) and double ($T_2$) excitations:

$$
T_1 = \sum_{i,a} t_{ia} \, a_a^\dagger a_i, \quad T_2 = \frac{1}{4} \sum_{i,j,a,b} t_{ijab} \, a_a^\dagger a_b^\dagger a_j a_i. [10]
$$

The amplitudes $t_{ia}$ and $t_{ijab}$ are determined by solving the standard CCSD amplitude equations.

---

### 3.3 The EOM Ansatz for Excited States

Excited states are obtained by applying an excitation operator $\hat{R}_k$ to the CC ground state:

$$
| \Psi_k \rangle = \hat{R}_k e^{\hat{T}} | \Phi_0 \rangle. [11]
$$

The operator $\hat{R}_k$ is expanded in the same excitation manifold as the CC cluster operator:

$$
\hat{R}_k = r_0^{(k)} + \sum_{i,a} r_{ia}^{(k)} a_a^\dagger a_i + \frac{1}{4} \sum_{i,j,a,b} r_{ijab}^{(k)} a_a^\dagger a_b^\dagger a_j a_i. [12]
$$

Here,

- $r_0^{(k)}$ is a possible “reference” component (often set to zero for excited states),
- $r_{ia}^{(k)}$ and $r_{ijab}^{(k)}$ are the excitation amplitudes for singles and doubles, respectively.

---

### 3.4 The Similarity-Transformed Hamiltonian and the EOM Eigenvalue Problem

A key concept in EOM-CCSD is the similarity-transformed Hamiltonian:

$$
\bar{H} = e^{-\hat{T}} H e^{\hat{T}}, [13]
$$

which is **non-Hermitian** but has the same eigenvalues as the original Hamiltonian. The excited state eigenvalue equation then reads:

$$
\bar{H} \hat{R}_k | \Phi_0 \rangle = E_k \hat{R}_k | \Phi_0 \rangle. [14]
$$

In practice, one typically solves for the **excitation energy relative to the ground state**:

$$
\Delta E_k = E_k - E_0,
$$

by projecting Eq. (14) onto the space of excited determinants:

$$
\langle \Phi_\mu | \bar{H} \hat{R}_k | \Phi_0 \rangle = \Delta E_k r_\mu^{(k)}, [15]
$$

where $| \Phi_\mu \rangle$ denotes a generic **singly or doubly excited determinant** from $| \Phi_0 \rangle$.

---

### 3.5 Detailed Structure and Computational Considerations

The matrix elements of $\bar{H}$ in the **singles and doubles space** are computed by transforming the Hamiltonian with the cluster amplitudes. Although the complete expressions are lengthy, key features include:

#### **Singles–Singles Block:**

$$
\langle \Phi_{ia} | \bar{H} | \Phi_{jb} \rangle \approx ( \epsilon_a - \epsilon_i ) \delta_{ij} \delta_{ab} + \tilde{V}_{ia,jb}, [16]
$$

where $\tilde{V}_{ia,jb}$ represents contributions from the transformed two-electron integrals that include correlation effects.

#### **Coupling to Doubles:**

The coupling between **single and double excitations** is critical for an accurate description of excited states. For example:

$$
\langle \Phi_{ia} | \bar{H} | \Phi_{jkbc} \rangle, [17]
$$

involves terms that depend on the $T_2$ amplitudes and the **bare two-electron integrals**. These couplings ensure that **dynamic correlation is properly incorporated**.

The eigenvalue problem in Eq. (15) is solved iteratively (often via **Davidson or Lanczos algorithms**) because the dimensionality of the singles+doubles space can be **very large**. The **non-Hermiticity** of $\bar{H}$ also necessitates care in choosing appropriate algorithms for convergence.

# 4. Comparative Analysis

## 4.1 Accuracy and Scope

**ROCIS and DFT/ROCIS:**  
These methods are relatively inexpensive and are well suited for systems where single excitations dominate. Their inclusion of spin–orbit coupling makes them particularly attractive for open-shell and heavy-element systems. However, because they are limited to the singles excitation manifold (with empirical corrections), they may miss important dynamic correlation effects present in multi-reference or strongly correlated excited states.

**EOM-CCSD:**  
EOM-CCSD is one of the “gold standard” methods for excited states, capable of accurately describing both valence and Rydberg excitations. By incorporating doubles (and implicitly higher excitations via the CC ansatz), it captures a significant fraction of electron correlation. The trade-off is a computational scaling that typically goes as  

$$
O(N^6)
$$  

with system size, which limits its application to small-to-medium-sized molecules.

---

## 4.2 Computational Considerations

**ROCIS/DFT-ROCIS:**  
With matrix dimensions determined by the number of single excitations, these methods are computationally efficient. Empirical adjustments (e.g., scaling factors in DFT/ROCIS) can be optimized for different chemical environments.

**EOM-CCSD:**  
The inclusion of double excitations dramatically increases the size of the excitation space. Sophisticated iterative solvers and approximations (such as partitioning of the excitation space) are employed to make these calculations tractable. The non-Hermiticity of the similarity-transformed Hamiltonian adds further numerical complexity.

---

# 5. Conclusion

In this blog we have provided a detailed, equation-rich overview of three advanced methods for treating excited states:

- **ROCIS** employs a configuration interaction singles approach tailored for open-shell systems and includes spin–orbit coupling effects. Its formulation [Eqs. (1)–(5)] offers a balance between computational efficiency and the ability to capture essential excited state features, particularly in systems with significant relativistic effects.

- **DFT/ROCIS** builds on this framework by using DFT-derived orbitals and energies, often with empirical scaling [Eq. (7)]. This hybrid method has gained popularity for its ability to reproduce experimental spectra in transition-metal complexes and other challenging systems.

- **EOM-CCSD** represents a highly accurate, albeit computationally demanding, method that leverages the coupled cluster ansatz to incorporate singles and doubles excitations [Eqs. (9)–(17)]. By solving the eigenvalue problem for the similarity-transformed Hamiltonian, EOM-CCSD can provide benchmark-quality excitation energies for a wide range of molecular systems.

Each method has its niche: **ROCIS and DFT/ROCIS** are efficient and tailored for systems where **spin–orbit and open-shell effects** are critical, while **EOM-CCSD** is the method of choice when **high accuracy** is required and the system size permits. The choice among these approaches depends on:

- The **chemical system** under study,
- The importance of **dynamic electron correlation**, and
- The available **computational resources**.


